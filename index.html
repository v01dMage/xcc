<!DOCTYPE html<html lang="en">
<head><meta charset="utf-8"><title>

xcc

</title><style>

html, body {
  height: 100%; 
  width: 100%;
  margin: 0;
  padding: 0;
}

body { 
  background: #111; 
  color: #00ff55; 
  display: flex;
  flex-direction: column-reverse;
}

#webButtons, #webTexts, #webOutput {
  width: 100%; 
  flex-grow: 0;
  flex-shrink: 0;
}

#webTexts {
  flex-basis: 30%; 
  display: flex;
  flex-direction: column;
}

#webButtons {
  flex-basis: 20%;
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
}

#webOutput {
  flex-basis: 50%; 
  border: 10px solid #0055FF; 
  border-radius: 5%;
  display: flex;
  flex-direction: column-reverse;
  overflow-y: auto;
  height: auto;
  background-color: #000000;
  opacity: 1; 
}

#commandLine, #webText {
  background: #111111; 
  color: #00FF77; 
  border: 4px solid #00FF77; 
  font-family: 'Consolas', 'Monaco', monospace;
  padding: 1em; 
  width: auto; 
  box-sizing: border-box;
}

#commandLine {
  flex-grow: 1; 
}

#webText {
  flex-grow: 2; 
}

#webButtons button {
  flex: 0 0 16%;
  height: 4em;
  padding: 1em;
  background: #0BF; 
  color: #FFF; 
  border: 2px solid #FFF;
}

#webButtons .runnable {
  background: #B7F; 
  color: #000000; 
  border: 2px solid #FFFFFF;
}


.pout {
  border: 5px solid gold; 
  margin: 2em;
  padding: 1em;
  border-radius: 5px;
  color: #00FF77; 
}

.pout.input-command {
  border: 5px solid #00BFFF; 
  color: #FFFFFF; 
}

.pout.result-output {
  border: 5px solid #00FF77; 
  color: #00FF77; 
}

.pout.error-output {
  border: 5px solid #FF0000; 
  color: #FF0000;
  font-weight: bold;
}

</style>
<script type="importmap">
  {
    "imports": {
      "three": "https://cdn.jsdelivr.net/npm/three@v0.180.0/build/three.module.js",
      "three/addons/": "https://cdn.jsdelivr.net/npm/three@v0.180.0/examples/jsm/",

    }
  }
</script>
</head><body>

<div id="webButtons">
  <button id="runButton" class="runnable"> Run </button>
</div>
<div id="webTexts">
  <textarea id="webText"></textarea>
  <textarea id="commandLine"></textarea>
</div>
<div id="webOutput"></div>

<script>

const webOutput= document.getElementById('webOutput');
const runButton= document.getElementById('runButton');
const commandLine= document.getElementById('commandLine');
const webText= document.getElementById('webText'); 


function printOutput(html, className = 'pout') {
    let p= document.createElement('p');
    p.innerHTML= html;
    p.className= className;
    webOutput.appendChild(p);
}


function runPsiRepl() {
    const code = commandLine.value.trim();

    if (!code) return; 
    printOutput(`> ${code}`, 'pout input-command'); 

    try {
        const result= (new Function('psi', code))({psi:13});
        const outputString= (result === undefined) ? 'undefined' : String(result);
        printOutput(`\u2190 ${outputString}`, 'pout result-output'); //Unicode left arrow

    } catch (e) {
        printOutput(`ERROR: ${e.message}`, 'pout error-output');
    }

    commandLine.value = '';
}

runButton.addEventListener("click", runPsiRepl);

commandLine.addEventListener("keydown", (event) => {
    if (event.key === 'Enter' && !event.shiftKey) {
        event.preventDefault(); // Prevent newline in textarea
        runPsiRepl();
    }
});

</script></body></html>
